<template>
    <div class={pageClass}>
        <builder-editor>
            <builder-header
                slot="header"
                title="Explorer"
                sub-title="SObject Explorer"
                icon-name="standard:bundle_config">
                <div slot="actions" class="slds-builder-toolbar__actions">
                    <lightning-button-group>
                        <lightning-button
                            icon-name="utility:link"
                            label="Object Manager"
                            onclick={goToUrl}
                            data-url="/lightning/setup/ObjectManager/home"></lightning-button>
                        <lightning-button-icon
                            icon-name="utility:filterList"
                            disabled={isLoading}
                            onclick={filtering_handleClick}
                            variant={filtering_variant}></lightning-button-icon>
                    </lightning-button-group>
                </div>
            </builder-header>
            <article class="full-page-body slds-card">
                <div
                        class="slds-card__body slds-card__body_inner slds-full-height"
                        style="overflow: hidden">
                        <div
                            class="slds-full-height slds-grid slds-gutters_direct slds-wrap slds-is-relative"
                            style="min-height: 200px">
                            <!-- Container -->
                            <slds-split-view
                                class="slds-fill-height"
                                left-min-width="200"
                                right-min-width="200"
                                splitter-position="30"
                                is-horizontal>
                                <div class="slds-flex-column slds-full-height slds-full-width slds-is-relativ slds-p-horizontal_x-small" slot="left">
                                    <slds-menu
                                        class="slds-flex-column slds-full-height min-height-200"
                                        items={formattedMenuItems}
                                        title="SObjects"
                                        onmenuselection={handleItemSelection}
                                        is-loading={isLoading}
                                        keep-filter={keepFilter}></slds-menu>
                                </div>
                                <div class="slds-flex-column slds-full-height slds-full-width slds-is-relative slds-p-horizontal_xx-small" slot="right">
                                    <!-- Tabs -->
                                    <slds-tabset
                                        lwc:ref="objectTab"
                                        variant="scoped"
                                        active-tab-value={activeTabId}
                                        onclosetab={handleTabClose}
                                    >
                                        <template for:each={formattedTabs} for:item="tab">
                                            <slds-tab
                                                key={tab.id}
                                                label={tab.name}
                                                value={tab.id}
                                                onactive={handleTabSelect}
                                                is-closeable
                                            ></slds-tab>
                                        </template>
                                    </slds-tabset>
                                    <div class="slds-is-relative slds-flex-column slds-fill-height slds-full-width">
                                        <!-- Content -->
                                        <template lwc:if={isViewerDisplayed}>
                                            <object-sobject
                                                object-records={records}
                                                record-name={currentTab.id}
                                            ></object-sobject>
                                        </template>
                                        <template lwc:else>
                                            <illustration-empty
                                                size="large"
                                                title="No record"
                                                sub-title="No SObject selected or found."
                                            ></illustration-empty>
                                        </template>
                                    </div>
                                </div>
                            </slds-split-view>
                        </div>
                    </div>
            </article>
            <!-- Panel -->
            <slds-vertical-panel
                has-border
                position="right"
                size="slds-size_small"
                title="Filters"
                is-open={displayFilter}
                onclose={handleCloseVerticalPanel}
            >
                <div class="slds-filters">
                    <ol class="slds-list_vertical slds-list_vertical-space">
                        <!-- FILTER -->
                        <li class="slds-item">
                            <lightning-checkbox-group
                                name="sobjectBasicFilter"
                                label="Metadata Filters"
                                options={metadataFilter_options}
                                value={metadataFilter_value}
                                onchange={metadataFilter_onChange}></lightning-checkbox-group>
                        </li>
                        <!-- FILTER -->
                        <li class="slds-item">
                            <lightning-checkbox-group
                                name="sobjectExtraFilter"
                                label="Advanced Filters"
                                options={typeFilter_options}
                                value={typeFilter_value}
                                onchange={typeFilter_onChange}></lightning-checkbox-group>
                        </li>
                    </ol>
                </div>
            </slds-vertical-panel>
        </builder-editor>
    </div>
</template>