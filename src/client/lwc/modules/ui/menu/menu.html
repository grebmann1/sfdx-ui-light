<template>
    <template lwc:if={isHeaderLightDisplayed}>
        <header>
            <!-- Navigation -->
            <div class="slds-context-bar slds-inner-menu-header">
                <div class="slds-context-bar__primary">
                    <div
                        class="slds-context-bar__item slds-context-bar__dropdown-trigger slds-dropdown-trigger slds-dropdown-trigger_click slds-no-hover"
                        style="display: flex; align-items: center">
                        <div class={collapseClass}>
                            <lightning-button-icon
                                icon-name={iconName}
                                variant="bare"
                                size="large"
                                onclick={handleToggle}></lightning-button-icon>
                        </div>
                        <template lwc:if={isTitleDisplayed}>
                            <span
                                class="slds-p-left_x-small slds-context-bar__label-action slds-context-bar__app-name">
                                <span class="slds-truncate" title="SF Toolkit">SF Toolkit</span>
                            </span>
                        </template>
                    </div>
                </div>
            </div>
        </header>
    </template>
    <div class="explorer-rail">
        <template lwc:if={isNotMenuSmall}>
            <div class="explorer-header">
                <h2 class="explorer-title">Explorer</h2>
            </div>
            <div class="explorer-search">
                <lightning-input
                    type="search"
                    placeholder="Search..."
                    value={filterText}
                    onchange={handleSearchInput}
                    variant="label-hidden"
                    icon-name="utility:search"
                    class="explorer-search-input">
                </lightning-input>
            </div>
        </template>
    </div>
    <lightning-vertical-navigation class="menu-header" onselect={handleApplicationSelection}>
        <!-- Home -->
        <lightning-vertical-navigation-section>
            <template for:each={filteredHomes} for:item="item">
                <template lwc:if={item.menuIcon}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}></lightning-vertical-navigation-item>
                </template>
            </template>
        </lightning-vertical-navigation-section>

        <template lwc:if={isMenuSmall}>
            <!-- SMALL MENU - START -->
            <!-- Explorers -->
            <template lwc:if={hasFilteredExplorers}>
                <lightning-button-menu
                    variant="container"
                    tooltip="Explorers"
                    icon-name="utility:builder"
                    onselect={handleApplicationSelection}>
                    <template for:each={filteredExplorers} for:item="item">
                        <lightning-menu-item
                            tooltip={item.menuLabel}
                            data-key={item.path}
                            key={item.name}
                            value={item.path}
                            label={item.menuLabel}
                            icon-name={item.menuIcon}></lightning-menu-item>
                    </template>
                </lightning-button-menu>
            </template>
            <!-- Developer -->
            <template lwc:if={hasFilteredDeveloperTools}>
                <lightning-button-menu
                    variant="container"
                    tooltip="Developer"
                    icon-name="utility:apex"
                    onselect={handleApplicationSelection}>
                    <template for:each={filteredDeveloperTools} for:item="item">
                        <lightning-menu-item
                            tooltip={item.menuLabel}
                            data-key={item.path}
                            key={item.name}
                            value={item.path}
                            label={item.menuLabel}
                            icon-name={item.menuIcon}></lightning-menu-item>
                    </template>
                </lightning-button-menu>
            </template>
            <!-- Data -->
            <template lwc:if={hasFilteredDataTools}>
                <lightning-button-menu
                    variant="container"
                    tooltip="Data"
                    icon-name="utility:download"
                    onselect={handleApplicationSelection}>
                    <template for:each={filteredDataTools} for:item="item">
                        <lightning-menu-item
                            tooltip={item.menuLabel}
                            data-key={item.path}
                            key={item.name}
                            value={item.path}
                            label={item.menuLabel}
                            icon-name={item.menuIcon}></lightning-menu-item>
                    </template>
                </lightning-button-menu>
            </template>
            <!-- Utilities -->
            <template lwc:if={hasFilteredUtilities}>
                <lightning-button-menu
                    variant="container"
                    tooltip="Utilities"
                    icon-name="utility:magicwand"
                    onselect={handleApplicationSelection}>
                    <template for:each={filteredUtilities} for:item="item">
                        <lightning-menu-item
                            tooltip={item.menuLabel}
                            data-key={item.path}
                            key={item.name}
                            value={item.path}
                            label={item.menuLabel}
                            icon-name={item.menuIcon}></lightning-menu-item>
                    </template>
                </lightning-button-menu>
                <div class="slds-has-divider_top-space"></div>
            </template>

            <!-- Connections -->
            <template lwc:if={isUnlimitedModeAndHasConnections}>
                <lightning-button-menu
                    variant="container"
                    tooltip="Connections"
                    icon-name="utility:connected_apps"
                    onselect={handleApplicationSelection}>
                    <template for:each={filteredConnections} for:item="item">
                        <lightning-menu-item
                            data-key={item.path}
                            key={item.name}
                            value={item.path}
                            label={item.menuLabel}
                            icon-name={item.menuIcon}></lightning-menu-item>
                    </template>
                </lightning-button-menu>
            </template>
            <div class="slds-has-divider_top-space"></div>
            <!-- Documentation -->
            <lightning-vertical-navigation-section>
                <template for:each={filteredDocumentations} for:item="item">
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        name={item.path}
                        title={item.menuLabel}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
            </lightning-vertical-navigation-section>
            <!-- SMALL MENU - END -->
        </template>
        <template lwc:else>
            <!-- LARGE MENU - START -->
            <!-- Explorers -->
            <template lwc:if={hasFilteredExplorers}>
                <h2 class="slds-nav-vertical__title">Explorers</h2>
            </template>
            <template for:each={filteredExplorers} for:item="item">
                <template lwc:if={item.menuIcon}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}></lightning-vertical-navigation-item>
                </template>
            </template>
            <!-- Developer -->
            <template lwc:if={hasFilteredDeveloperTools}>
                <div class="slds-has-divider_top-space"></div>
                <h2 class="slds-nav-vertical__title">Developer</h2>
            </template>

            <template for:each={filteredDeveloperTools} for:item="item">
                <template lwc:if={item.menuIcon}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}></lightning-vertical-navigation-item>
                </template>
            </template>
            <!-- Data -->
            <template lwc:if={hasFilteredDataTools}>
                <div class="slds-has-divider_top-space"></div>
                <h2 class="slds-nav-vertical__title">Data</h2>
            </template>
            <template for:each={filteredDataTools} for:item="item">
                <template lwc:if={item.menuIcon}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}></lightning-vertical-navigation-item>
                </template>
            </template>
            <!-- Utilities -->
            <template lwc:if={hasFilteredUtilities}>
                <div class="slds-has-divider_top-space"></div>
                <h2 class="slds-nav-vertical__title">Utilities</h2>
            </template>
            <template for:each={filteredUtilities} for:item="item">
                <template lwc:if={item.menuIcon}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}></lightning-vertical-navigation-item>
                </template>
            </template>
            <!-- Connections -->
            <template lwc:if={isUnlimitedModeAndHasConnections}>
                <div class="slds-has-divider_top-space"></div>
                <template for:each={filteredConnections} for:item="item">
                    <template lwc:if={item.menuIcon}>
                        <lightning-vertical-navigation-item-icon
                            data-key={item.path}
                            key={item.name}
                            label={item.menuLabel}
                            name={item.path}
                            icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                    </template>
                    <template lwc:else>
                        <lightning-vertical-navigation-item
                            data-key={item.path}
                            key={item.name}
                            label={item.menuLabel}
                            name={item.path}></lightning-vertical-navigation-item>
                    </template>
                </template>
            </template>
            <!-- Documentation -->
            <div class="slds-has-divider_top-space"></div>
            <template for:each={filteredDocumentations} for:item="item">
                <template lwc:if={item.menuIcon}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item
                        data-key={item.path}
                        key={item.name}
                        label={item.menuLabel}
                        name={item.path}></lightning-vertical-navigation-item>
                </template>
            </template>
            <!-- LARGE MENU - END -->
        </template>
        <div class="slds-has-divider_top-space"></div>
        <!-- Others -->
        <template lwc:if={isNotMenuSmall}>
            <h2 class="slds-nav-vertical__title">Others</h2>
        </template>
        <lightning-vertical-navigation-section>
            <template for:each={filteredExtras} for:item="item">
                <template lwc:if={isMenuSmall}>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        key={item.name}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
                <template lwc:else>
                    <lightning-vertical-navigation-item-icon
                        data-key={item.path}
                        label={item.menuLabel}
                        key={item.name}
                        name={item.path}
                        icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
                </template>
            </template>
            <template for:each={filteredOthers} for:item="item">
                <lightning-vertical-navigation-item-icon
                    key={item.name}
                    onclick={handleRedirection}
                    data-url={item.url}
                    data-key={item.path}
                    label={item.menuLabel}
                    name={item.name}
                    icon-name={item.menuIcon}></lightning-vertical-navigation-item-icon>
            </template>
        </lightning-vertical-navigation-section>
    </lightning-vertical-navigation>
</template>
